<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>网星工作台-账号设置</title>
    <!--#include file="public/htmlhead.html"-->
</head>

<body>
    <!-- 头部内容 -->
    <div class="contianer-fluid">
        <div class="row">
            <!--#include file="public/header.html"-->
        </div>
    </div>
    <!-- 内容部分 -->
    <div class="container">
        <div class="row">
            <div class="main">
                <div class="main-row">
                    <!-- 页面左侧内容 -->
                    <div class="main-col">
                        <!-- 用户信息 -->
                        <div class="panel">
                            <!--#include file="public/user-info.html"-->
                        </div>
                        <!-- 左侧导航 -->
                        <div class="panel">
                            <!--#include file="public/nav.html"-->
                        </div>
                    </div>
                    <div class="main-col">
                        <!-- 权限配置 -->
                        <div class="panel">
                            <div class="panel-header">
                                <div class="title">
                                    <span>账号设置</span>
                                </div>
                            </div>
                            <div class="panel-body">
                                <!-- 表单 -->
                                <div class="form form-list form-setting">
                                    <form action="">
                                        <div class="form-group" id="servicesettinginfo">
                                            <div class="form-item">
                                                <label for="" class="control-label">登录名：</label>
                                                <div class="input-group">
                                                    <input type="text" class="form-control" v-model= "logonName" placeholder=""
                                                        value="zhangwenyuan" readonly>
                                                </div>
                                                <a class="btn btn-primary btn-outline" href="#">
                                                    <span>修改</span>
                                                </a>
                                            </div>
                                            <div class="form-item">
                                                <label for="" class="control-label">姓名：</label>
                                                <div class="input-group">
                                                    <input type="text" class="form-control" v-model= "fullName"  placeholder="" value="张文远"
                                                        readonly>
                                                </div>
                                            </div>
                                            <div class="form-item">
                                                <label for="" class="control-label">手机号：</label>
                                                <div class="input-group">
                                                    <input type="text" class="form-control" placeholder=""
                                                        value="" v-model= "phoneNumber" readonly>
                                                </div>
                                                <a class="btn btn-primary btn-outline" href="#">
                                                    <span>修改</span>
                                                </a>
                                            </div>
                                            <div class="form-item">
                                                <label for="" class="control-label">短信验证：</label>
                                                <div class="input-group">
                                                    <input type="text" class="form-control" placeholder="">
                                                    <div class="input-group-btn">
                                                        <a class="btn btn-primary btn-outline">
                                                            <span>获取验证码</span>
                                                        </a>
                                                    </div>
                                                </div>
                                                <a class="btn btn-primary btn-outline" href="#">
                                                    <span>绑定</span>
                                                </a>
                                            </div>
                                            <div class="form-item">
                                                <label for="" class="control-label">注册时间：</label>
                                                <div class="input-group">
                                                    <input type="text" class="form-control" placeholder=""
                                                        value="" v-model="registerTime" readonly>
                                                </div>
                                            </div>
                                            <div class="form-item">
                                                <label for="" class="control-label">密码：</label>
                                                <div class="input-group">
                                                    <input type="password" class="form-control" placeholder=""
                                                        value="123456" readonly >
                                                </div>
                                                <a class="btn btn-primary btn-outline" href="#">
                                                    <span>修改</span>
                                                </a>
                                            </div>
                                            <div class="form-item">
                                                <label for="" class="control-label"><i
                                                        class="icon-warning"></i>微信：</label>
                                                <div class="input-group">
                                                    <input type="text" class="form-control" placeholder="" value="未绑定"
                                                        readonly>
                                                    <div class="input-group-addon">
                                                        当前的帐号还未绑定微信帐号，绑定后可用微信帐号直接登录
                                                    </div>
                                                </div>
                                                <a class="btn btn-primary btn-outline" href="javascript:()" id="ns-wxchat-bind">
                                                    <span>绑定</span>
                                                </a>
                                            </div>
                                            <div class="form-item">
                                                <label for="" class="control-label"><i
                                                        class="icon-warning"></i>企业微信：</label>
                                                <div class="input-group">
                                                    <input type="text" class="form-control" placeholder="" value="未绑定"
                                                        readonly>
                                                    <div class="input-group-addon">
                                                        当前的帐号还未绑定企业微信，绑定后可用企业微信直接登录
                                                    </div>
                                                </div>
                                                <a class="btn btn-primary btn-outline" href="javascript:()" id="ns-qywxchat-bind">
                                                    <span>绑定</span>
                                                </a>
                                            </div>
                                            <div class="form-item">
                                                <label for="" class="control-label"><i
                                                        class="icon-warning"></i>QQ：</label>
                                                <div class="input-group">
                                                    <input type="text" class="form-control" placeholder="" value="未绑定"
                                                        readonly>
                                                    <div class="input-group-addon">
                                                        当前的帐号还未绑定QQ，绑定后可用QQ账号直接登录
                                                    </div>
                                                </div>
                                                <a class="btn btn-primary btn-outline" href="javascript:" >
                                                    <span>绑定</span>
                                                </a>
                                            </div>
                                            <div class="form-item">
                                                <label for="" class="control-label"><i
                                                        class="icon-warning"></i>短信验证登录：</label>
                                                <div class="input-group">
                                                    <input type="text" class="form-control" placeholder="" value="未绑定"
                                                        readonly>
                                                    <div class="input-group-addon">
                                                        您的帐号还未设置短信验证登录，如设置短信验证后，下次登录需要接受短信验证
                                                    </div>
                                                </div>
                                                <a class="btn btn-primary btn-outline" href="#">
                                                    <span>绑定</span>
                                                </a>
                                            </div>
                                            <script>
                                                var serverRootPath = 'https://qaapi.wangxingcloud.com/';
                                                var MyServiceSetting = {
                                                    getScanCodeUrl:function(){
                                                 /*        var regUrls =  {
                                                            'https://qa.wangxingcloud.com/':'https://qa.wangxingcloud.com/',
                                                            'https://wangxingcloud.com/':'https://wangxingcloud.com/',
                                                        } */
                                                        var logonUrl = window.location.href
                                                        return logonUrl
                                                    },
                                                    /* 跳转微信绑定扫码页面 */
                                                    bingWeChatUrl:function(){
                                                        var _this = this;
                                                         $.ajax({
                                                            url:serverRootPath + '/workweixin/weChatLogin/getWeChatBindUrl',
                                                            dataType:'text',
                                                            type: "GET",
                                                            data:{
                                                                domain:_this.getScanCodeUrl()
                                                            },
                                                            success:function(res){
                                                                var wxChaturl = res;
                                                                $('#ns-wxchat-bind').attr('href',wxChaturl)
                                                                
                                                            }
                                                        })
                                                    }, 
                                                    /* 跳转企业微信绑定扫码页面 */
                                                    bingqyWeChatUrl:function(){
                                                        var _this = this;
                                                         $.ajax({
                                                            url:serverRootPath + '/workweixin/workWeixinUserEmps/getBindWorkWxUrl',
                                                            dataType:'text',
                                                            type: "GET",
                                                            data:{
                                                                domain:_this.getScanCodeUrl()
                                                            },
                                                            success:function(res){
                                                                var qywxChaturl = res;
                                                                $('#ns-qywxchat-bind').attr('href',qywxChaturl)
                                                                
                                                            }
                                                        })
                                                    }, 

                                                    //微信绑定
                                                   bingWeChat:function(){
                                                       var bindUrlParams = NetStarUtils.getUrlPara()
                                                       if(bindUrlParams.code && bindUrlParams.state){ 
                                                            $.ajax({
                                                                url:serverRootPath + '/workweixin/weChatLogin/bindWeChat',
                                                                dataType:'text',
                                                                type: "GET",
                                                                headers:{
                                                                    Authorization:NetStarUtils.OAuthCode.get()
                                                                },
                                                                data:{
                                                                    code:loginUrlParams.code,
                                                                    state:loginUrlParams.state
                                                                },
                                                                success:function(res){
                                                                   if(res.success == false){
                                                                       nsalert('绑定失败');
                                                                       console.log('绑定失败',)
                                                                   }else{
                                                                       nsalert('绑定成功',success);
                                                                       $('.input-group-addon').text('已绑定')
                                                                   }
                                                                },
                                                                error:function(error){
                                                                    nsalert('绑定失败')
                                                                }
                                                            })
                                                       }    
                                                    },
                                                
                                                 //企业微信绑定
                                                    bingqyWeChat:function(){
                                                        var bindUrlParams = NetStarUtils.getUrlPara()
                                                        if(bindUrlParams.code && bindUrlParams.state){ 
                                                                $.ajax({
                                                                    url:serverRootPath + '/workweixin/weChatLogin/bindWeChat',
                                                                    dataType:'text',
                                                                    type: "GET",
                                                                    headers:{
                                                                        Authorization:NetStarUtils.OAuthCode.get()
                                                                    },
                                                                    data:{
                                                                        code:loginUrlParams.code,
                                                                        state:loginUrlParams.state
                                                                    },
                                                                    success:function(res){
                                                                    if(res.success == false){
                                                                        nsalert('绑定失败');
                                                                        console.log('绑定失败',)
                                                                    }else{
                                                                        nsalert('绑定成功',success);
                                                                        $('.input-group-addon').text('已绑定')
                                                                    }
                                                                    },
                                                                    error:function(error){
                                                                        nsalert('绑定失败')
                                                                    }
                                                                })
                                                        }    
                                                        }
                                                    }
                                            
                                                MyServiceSetting.bingWeChatUrl();
                                                MyServiceSetting.bingWeChat(); 
                                                MyServiceSetting.bingqyWeChatUrl();
                                                MyServiceSetting.bingqyWeChat();             
                                            </script>
                                        </div>
                                        <script>     
                                            var userInfo = store.get('MyServiceUserInfo').userInfo 

                                            var serviceSettingInfo = new Vue({
                                                el:'#servicesettinginfo',
                                                data:{
                                                    logonName:userInfo.account,//登录名
                                                    fullName:userInfo.userName,//姓名
                                                    phoneNumber:userInfo.mobile,//手机号
                                                    registerTime: moment(userInfo.startTime).format("YYYY-MM-DD HH:mm:s"),//注册时间

                                                },
                                                methods:{
                                                    timestampToString:function(time){
                                                        time = userInfo.startTime  
                                                        var newTime = moment(time).format("YYYY-MM-DD HH:mm:s");
                                                        this.registerTime = newTime
                                                    }
                                                }
                                                
                                            })
                                        </script>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

</html>