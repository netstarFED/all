<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
    <meta name="description" content="扫码详情表" />
    <meta name="author" content="netstar" />
    <!--# include file="/sites/include/static_mobile.html" -->
    <title>留样邮寄/留样摧毁</title>
</head>

<body class="weixin-type">
    <container>
        <script type="text/javascript">
            $(function () {
                var samplecoDeprinting = {
                    "package": "nscloud.Samplecodeprinting",
                    "template": "docListViewerMobile",
                    "readonly": false,
                    "isShowTitle": true,
                    "isFormHidden": false,
                    "versionNumber": "1",
                    "components": [{
                            "type": "blockList",
                            "field": [{
                                    "englishName": "sampleCode",
                                    "chineseName": "样品编号",
                                    "variableType": "string",
                                    "field": "sampleCode",
                                    "title": "样品编号",
                                    "mindjetType": "text",
                                    "isSet": "是",
                                    "displayType": "all",
                                    "gid": "6117f220-c87b-e0bd-2962-2600c4a5feac",
                                    "voName": "sampleSampleVO",
                                    "editConfig": {
                                        "id": "sampleCode",
                                        "englishName": "sampleCode",
                                        "chineseName": "样品编号",
                                        "variableType": "string",
                                        "mindjetType": "text",
                                        "isSet": "是",
                                        "displayType": "all",
                                        "gid": "6117f220-c87b-e0bd-2962-2600c4a5feac",
                                        "voName": "sampleSampleVO",
                                        "className": "java.lang.String",
                                        "type": "text",
                                        "label": "样品编号",
                                        "disabled": false,
                                        "hidden": false,
                                        "isDistinct": false
                                    },
                                    "editable": false,
                                    "hidden": false,
                                    "orderable": true,
                                    "searchable": true,
                                    "tooltip": false,
                                    "isDefaultSubdataText": true,
                                    "width": 130,
                                    "formatHandler": {
                                        "type": "href",
                                        "data": {
                                            "url": getRootPath() +"/templateMindPages/pageConfig/1316994910712234994?editModel=2&saveParams=1",
                                            "title": "合同明细",
                                            "field": "sampleCode",
                                            "readonly": false,
                                            "templateName": "limsReg"
                                        }
                                    },
                                    "columnType": "href",
                                    "mindjetIndexState": 0
                                },
                                {
                                    "englishName": "sampleName",
                                    "chineseName": "样品名称",
                                    "variableType": "string",
                                    "field": "sampleName",
                                    "title": "样品名称",
                                    "mindjetType": "text",
                                    "isSet": "是",
                                    "displayType": "all",
                                    "gid": "8bdb710e-42ab-5b04-c756-4ce6ab3fa5ee",
                                    "voName": "sampleSampleVO",
                                    "editConfig": {
                                        "id": "sampleName",
                                        "englishName": "sampleName",
                                        "chineseName": "样品名称",
                                        "variableType": "string",
                                        "mindjetType": "text",
                                        "isSet": "是",
                                        "displayType": "all",
                                        "gid": "8bdb710e-42ab-5b04-c756-4ce6ab3fa5ee",
                                        "voName": "sampleSampleVO",
                                        "className": "java.lang.String",
                                        "type": "text",
                                        "label": "样品名称",
                                        "disabled": false,
                                        "hidden": false,
                                        "isDistinct": false
                                    },
                                    "editable": false,
                                    "hidden": false,
                                    "orderable": true,
                                    "searchable": true,
                                    "tooltip": false,
                                    "isDefaultSubdataText": true,
                                    "width": 106,
                                    "mindjetIndexState": 1
                                },
                                {
                                    "englishName": "entrustName",
                                    "chineseName": "委托方名称",
                                    "variableType": "string",
                                    "field": "entrustName",
                                    "title": "委托方",
                                    "mindjetType": "text",
                                    "isSet": "是",
                                    "displayType": "all",
                                    "gid": "322366b5-fa80-3b41-52c5-bec171fa5a70",
                                    "voName": "sampleSampleVO",
                                    "editConfig": {
                                        "id": "entrustName",
                                        "englishName": "entrustName",
                                        "chineseName": "委托方名称",
                                        "variableType": "string",
                                        "mindjetType": "text",
                                        "isSet": "是",
                                        "displayType": "all",
                                        "gid": "322366b5-fa80-3b41-52c5-bec171fa5a70",
                                        "voName": "sampleSampleVO",
                                        "className": "java.lang.String",
                                        "type": "text",
                                        "label": "委托方",
                                        "disabled": false,
                                        "hidden": false,
                                        "isDistinct": false
                                    },
                                    "editable": false,
                                    "hidden": false,
                                    "orderable": true,
                                    "searchable": true,
                                    "tooltip": false,
                                    "isDefaultSubdataText": true,
                                    "mindjetIndexState": 2,
                                    "width": 200
                                },
                                {
                                    "englishName": "whenCreated",
                                    "chineseName": "创建时间",
                                    "variableType": "date",
                                    "field": "whenCreated",
                                    "title": "创建时间",
                                    "mindjetType": "date",
                                    "isSet": "是",
                                    "displayType": "all",
                                    "gid": "69f2080b-45c8-a187-572c-fbaaf454be1e",
                                    "voName": "sampleSampleVO",
                                    "editConfig": {
                                        "id": "whenCreated",
                                        "englishName": "whenCreated",
                                        "chineseName": "创建时间",
                                        "variableType": "date",
                                        "mindjetType": "date",
                                        "isSet": "是",
                                        "displayType": "all",
                                        "gid": "69f2080b-45c8-a187-572c-fbaaf454be1e",
                                        "voName": "sampleSampleVO",
                                        "className": "java.util.Date",
                                        "type": "date",
                                        "label": "创建时间",
                                        "disabled": false,
                                        "hidden": false,
                                        "isDistinct": false
                                    },
                                    "editable": false,
                                    "hidden": false,
                                    "orderable": true,
                                    "searchable": false,
                                    "tooltip": false,
                                    "isDefaultSubdataText": true,
                                    "width": 100,
                                    "formatHandler": {
                                        "type": "date",
                                        "data": {
                                            "formatDate": "YYYY-MM-DD"
                                        }
                                    },
                                    "columnType": "date",
                                    "mindjetIndexState": 3
                                }
                            ],
                            "ajax": {
                                "src": getRootPath() + "/sample/accept/samples/getPage",
                                "dataSrc": "rows",
                                "type": "POST",
                                "dataFormat": "object",
                                "contentType": "application/json",
                                "data": {}
                            },
                            "voId": "1309183777171316713",
                            "idField": "id",
                            "params":{"isServerMode":true},
                            "parent": "root",
                            "listExpression": "<div class=\"block-list-item\">\n<div class=\"block-list-item-text text-left\"><span><p class='fontWeight'>{{sampleName}}</p></span></div>\n<div class=\"block-list-item-text text-left\"><span><p style=\"color:#CCCCCC;\">{{sampleCode}}</p></span></div>\n<div class=\"block-list-item-text text-left\"><span class=\"info\"><p style=\"color:#6C6C6C;\" class=\"block-list-item-text-content\">{{entrustName}}</p></span></div>\n<div class=\"block-list-item-text text-left\"><span class=\"time\"><p>{{whenCreated}}</p></span></div>\n</div>",
                            "isUseSearchInput": true,
                            "searchInputPlaceholder": "样品编码",
                            "isUseQRInput": false,
                            "gid": "bb59d2fe-45d3-7289-99bc-9b7320c8b272",
                            "objectState": 2,
                            "hide": [
                                null
                            ]
                        },
                        {
                            "type": "btns",
                            "position": "footer-right",
                            "field": [],
                            "gid": "c2668055-59f1-4db1-7b73-0ab7c456e263",
                            "objectState": 2
                        }
                    ],
                    "draftBox": {
                        "isUse": false,
                        "isUseSave": true
                    },
                    "title": "样品编码打印（手机端）",
                    /* "pageParam": {} */
                }
                // NETSTAR添加url参数即pageParam
                samplecoDeprinting = NetstarProject.init(samplecoDeprinting);
                var pageConfig = {config:samplecoDeprinting};
                var componentsArr = pageConfig.config.components;
                for(var componentI=0; componentI<componentsArr.length; componentI++){
                    var componentData = componentsArr[componentI];
                    switch(componentData.type){
                        case 'btns':
                            componentData.field = [
                                {
                                    btn: {
                                        text: "打印",
                                        isReturn: true,
                                        handler: function (callBack, Obj) {
                                            $('[nspanel="moblieButtons"]').remove();
                                            var numStr = prompt("请输入打印数量：","1");
                                            if(numStr === null){ 
                                                console.warn('已经取消打印');
                                                return false;
                                            }
                                            var num = Number(numStr);
                                            if(isNaN(num) || numStr === '' || num === 0){
                                                nsAlert('请输入正确的数字', 'error');
                                                console.error('请输入正确的数字');
                                                return false;
                                            }
                                            var getPageConfig = callBack.dialogBeforeHandler(callBack);
                                            var templateConfig = getPageConfig.config;
                                            var valueData = getPageConfig.value;
                                            if(typeof(NetstarAppPlugin) == "object" && typeof(NetstarAppPlugin.lpApi) == "object"){
                                                var printConfig = {
                                                    // QRCodeField : 'id',
                                                    // codeField : 'sampleCode',
                                                    QRCodeField : 'sampleCode',
                                                    codeField : 'id',
                                                    nameField : 'sampleName',
                                                    // specsField : 'sampleCateName',
                                                    specsField : 'specification',
                                                    numField : 'sampleQuantity',
                                                    // userField : 'entrustName',createdByName
                                                    userField : 'createdByName',
                                                    title : "国家金属制品质量监督检验中心",
                                                    type : 'max2',
                                                };
                                                var valueDatas = valueData;
                                                if(!$.isArray(valueDatas)){
                                                    valueDatas = [valueDatas];
                                                }
                                                if(num > 1){
                                                    for(var i=1; i<num; i++){
                                                        valueDatas.push(valueData);
                                                    }
                                                }
                                                NetstarAppPlugin.lpApi.printByData(valueDatas, printConfig);
                                            }
                                        }
                                    },
                                    functionConfig: {
                                        isMobileInlineBtn:true,
                                    }
                                }
                            ]
                            break;
                    }
                }
                NetstarTemplate.init(samplecoDeprinting);

            });
            var innerHTML = 
                `<header class="header">
                    <div class="btn-group">
                        <a href="##" class="btn btn-icon">
                            <i class="icon icon-arrow-left-o"></i>
                        </a>
                    </div>
                    <div class="title">样品编码打印</div>
                    <div class="btn-group">
                        
                    </div>
                </header>`; 
            
            $("container").prepend(innerHTML);
            if($("header").length != 0 && $(".mobile-input-search").length == 0){
                $("container").addClass("padding-top-header");
            }
            if($("header").length != 0 && $(".mobile-input-search").length != 0){
                $("container").addClass("padding-top-header-search");
            }
        </script>
    </container>
</body>

</html>